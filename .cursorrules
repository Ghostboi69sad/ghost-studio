# Protected Components & Submodules
- src/container/Homepage/index.jsx:
  - لا يمكن تعديل المحتوى إلا لإصلاح الأخطاء
  - يتطلب موافقة للتغييرات
  - يجب توثيق أي تغييرات
  - يجب اختبار التغييرات قبل التنفيذ

- src/course-listing: # submodule
  - مجلد فرعي مستقل
  - يتم تحديثه من مستودع منفصل
  - يتطلب تحديث الإشارة للمستودع الفرعي بعد التغييرات
  - components/course-listing.tsx:
    - لا يمكن تعديل المحتوى إلا لإصلاح الأخطاء
    - يتطلب موافقة للتغييرات
    - يجب توثيق أي تغييرات
    - يجب اختبار التغييرات قبل التنفيذ
    - التحقق من صلاحيات المشرف قبل التعديل/الإضافة/الحذف
    - عرض الدورات حسب نوع الوصول (مجاني/اشتراك/مدفوع)
    - ربط الدورات المدفوعة مع Stripe
    - تحديث حالة الدورة في قاعدة البيانات في الوقت الفعلي
    - صفحة فريدة لكل دورة عند النشر

- src/course: # submodule
  - مجلد فرعي مستقل
  - يتم تحديثه من مستودع منفصل
  - يتطلب تحديث الإشارة للمستودع الفرعي بعد التغييرات
  - components/domestika-course-creator-s3.tsx:
    - لا يمكن تعديل المحتوى إلا لإصلاح الأخطاء
    - يتطلب موافقة للتغييرات
    - يجب توثيق أي تغييرات
    - يجب اختبار التغييرات قبل التنفيذ
    - التحقق من صلاحيات المشرف قبل التعديل
    - إمكانية تحديد نوع الوصول للدورة (مجاني/اشتراك/مدفوع)
    - ربط مع Stripe للدورات المدفوعة
    - تحديث في الوقت الفعلي
    - إنشاء صفحة فريدة لكل دورة
    - رفع وإدارة الوسائط باستخدام Amazon S3
    - تحسين أداء تحميل الوسائط

# AWS S3 Rules
- تنظيم الملفات:
  - /courses/media: للفيديوهات والملفات التعليمية
  - /courses/thumbnails: لصور الدورات
  - /users/uploads: لملفات المستخدمين
- الأمان:
  - تشفير الملفات في الراحة وأثناء النقل
  - تقييد الوصول حسب نوع المستخدم
  - نسخ احتياطي تلقائي
- الأداء:
  - استخدام CloudFront CDN
  - ضغط الملفات
  - تحميل تدريجي للوسائط

# AWS SES Rules
- إدارة البريد الإلكتروني:
  - إرسال رسائل التأكيد
  - إشعارات الاشتراك
  - تحديثات الدورات
  - استعادة كلمة المرور
- الأمان:
  - التحقق من صحة البريد الإلكتروني
  - مكافحة البريد المزعج
  - تتبع حالة التسليم
- المراقبة:
  - تتبع معدل الفتح
  - تتبع معدل النقر
  - تحليل الأداء

# Course Access Rules
- أنواع الوصول للدورات:
  - دورات مجانية: متاحة للجميع
  - دورات اشتراك: تتطلب اشتراك نشط
  - دورات مدفوعة: تتطلب شراء منفرد
- صلاحيات المستخدمين:
  - المشرف: إضافة/تعديل/حذف الدورات
  - المستخدم العادي: مشاهدة الدورات حسب نوع الوصول
- التحقق من الصلاحيات:
  - التحقق من حالة الاشتراك
  - التحقق من المشتريات
  - التحقق من صلاحيات المشرف

# Style & Functionality Rules
- عند إنشاء أو تعديل أي صفحة:
  - يجب اتباع نفس أسلوب التصميم الموجود
  - الحفاظ على الوظائف الأساسية
  - استخدام نفس المكونات المشتركة
  - اتباع نفس هيكل الكود والتنسيق
  - استخدام نفس الألوان والخطوط
  - الحفاظ على التجاوب مع جميع الشاشات
  - توثيق أي تغييرات في الأسلوب

# Security Rules
- تشفير البيانات الحساسة
- حماية نقاط النهاية API
- التحقق من المدخلات
- نسخ احتياطي للبيانات
- حماية مسارات المستخدم المصادق

# Performance Rules
- تحسين تحميل الوسائط
- التخزين المؤقت
- تقسيم الكود
- تحميل تدريجي للبيانات
- تحسين أداء الصور والفيديو

# Deployment Rules
- إنشاء صفحة فريدة لكل دورة
- تحسين SEO لكل صفحة
- تكوين روابط دائمة
- تحسين الأداء على Netlify
- نشر التحديثات تدريجياً

# حذف المجلدات الفرعية
Remove-Item -Path .git/modules/* -Recurse -Force
Remove-Item -Path src/course -Recurse -Force
Remove-Item -Path src/course-listing -Recurse -Force

# لغاء تهيئة المجلدات الفرعية
git submodule deinit -f .

# إعادة تهيئة المجلدات الفرعية
git submodule init
git submodule update --init --recursive
git submodule update --remote

# Workspace Rules
- المشروع الرئيسي:
  - يجب أن يكون له index.html خاص به
  - يستخدم React Router للتنقل
  - يتكامل مع المجلدات الفرعية
  - يدير حالة المصادقة المركزية

- المجلدات الفرعية:
  - تعمل كتطبيقات Next.js مستقلة
  - تستخدم نفس مكونات UI المشتركة
  - تشترك في نفس التكوينات الأساسية
  - تدعم SSR للصفحات الفردية

# Build Rules
- المشروع الرئيسي:
  command: yarn build
  output: dist/
  
- course submodule:
  command: yarn workspace course build
  output: src/course/.next/
  
- course-listing submodule:
  command: yarn workspace course-listing build
  output: src/course-listing/.next/

# Deployment Rules
- يجب نشر جميع المساحات في نفس الوقت
- استخدام yarn workspaces للبناء
- تكوين Next.js للمجلدات الفرعية
- تكوين التوجيهات لكل مساحة عمل

# Stripe Integration Rules
- التحقق من الاشتراكات:
  - التحقق من حالة الاشتراك قبل الوصول للدورات
  - تحديث حالة الاشتراك في الوقت الفعلي
  - معالجة webhook events
  - إدارة المدفوعات والاشتراكات

- أمان المدفوعات:
  - التحقق من صحة webhook signatures
  - تشفير بيانات الدفع
  - تتبع محاولات الدفع
  - معالجة الأخطاء والاستثناءات